import{k as Q,a4 as re,i as e,c as t,S as T,d as f,a5 as y,a2 as K,N as Y,F as I,a1 as ie,ay as ce,p as ee,P as oe,b as g,D as R,a3 as te,v as de}from"./vendor-LFOJg3vZ.js";import{u as j,ae as ue,af as M,ag as ge,B as D,ah as x,ai as pe,aj as he,ak as ve,al as fe,am as be,an as me,ao as _e,ap as $e,aq as xe,ar as Ce,b as ke,as as ye,at as O,au as W,av as Se,aw as we,ad as Ee,ax as De,ay as Z,az as Te,aA as J,aB as Le,aC as Ne,aD as Pe,aE as Ae,aF as Ie,aG as Fe}from"./index-QJLdVa23.js";import{C as S}from"./ConfigTitle-hXjZ_Yxi.js";const Be=f('<div class="flex flex-col p-4">'),Re=f('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><input type=search name=name class="input input-bordered min-w-0 flex-1"placeholder=google.com><div class="flex items-center gap-2"><select name=type class="select select-bordered"><option>A</option><option>AAAA</option><option>MX'),je=f("<div class=py-2>"),Oe=f('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),Ge=f('<div class="grid grid-cols-2 gap-2 sm:grid-cols-4"><div class=form-control><label for=enable-allow-lan class="label gap-2"><span class=label-text></span></label><input id=enable-allow-lan type=checkbox class=toggle></div><div class=form-control><label for=enable-tun-device class="label gap-2"><span class=label-text></span></label><input id=enable-tun-device type=checkbox class=toggle></div><div class=form-control><label for=tun-ip-stack class="label gap-2"><span class=label-text></span></label><select id=tun-ip-stack class="select select-bordered flex-1"><option>Mixed</option><option>gVisor</option><option>System</option><option>LWIP</option></select></div><div class=form-control><label for=device-name class="label gap-2"><span class=label-text></span></label><input id=device-name class="input input-bordered min-w-0"></div><div class=form-control><label for=interface-name class="label gap-2"><span class=label-text></span></label><input id=interface-name class="input input-bordered min-w-0">'),Me=f('<div class="flex flex-col gap-4"><select class="select select-bordered"><option></option><option></option><option></option></select><div class="grid grid-cols-2 gap-2 sm:grid-cols-3">'),Qe=f('<div class=form-control><label class=label><span class=label-text></span></label><input type=number class="input input-bordered">'),Ue=f('<div class="flex flex-col gap-2"><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><select class="select select-bordered">'),qe=f('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle></div><div class="flex flex-col"><select class="select select-bordered"></select></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle>'),G=f("<option>"),Ve=f('<span class="absolute -right-1 -top-1 flex h-3 w-3"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-info opacity-75"></span><span class="inline-flex h-3 w-3 rounded-full bg-info">'),ze=f('<div class="grid grid-cols-2 gap-4"><kbd class=kbd></kbd><div class=relative><kbd class="kbd w-full">'),He=f('<div class="mx-auto flex max-w-screen-md flex-col gap-4">'),Xe=y.object({name:y.string(),type:y.string()}),We=()=>{const[r]=j(),l=ge(),{form:_,isSubmitting:s}=K({extend:te({schema:Xe}),onSubmit:h=>l.get("dns/query",{searchParams:{name:h.name,type:h.type}}).json().then(({Answer:i})=>C((i==null?void 0:i.map(({data:o})=>o))||[])).catch(i=>de.error(i.message))}),[b,C]=Q([]);return(()=>{const h=Re(),i=h.firstChild,o=i.firstChild,n=o.nextSibling;return n.firstChild,Y(_,i,()=>_),e(n,t(D,{type:"submit",class:"btn-primary",get loading(){return s()},get children(){return r("dnsQuery")}}),null),e(h,t(T,{get when(){return b().length>0},get children(){const $=Be();return e($,t(I,{get each(){return b()},children:d=>(()=>{const p=je();return e(p,d),p})()})),$}}),null),h})()},Ze=y.object({port:y.number(),"socks-port":y.number(),"redir-port":y.number(),"tproxy-port":y.number(),"mixed-port":y.number()}),Je=({backendVersion:r})=>{const[l]=j(),_=ie(),s=[{label:()=>l("port",{name:"HTTP"}),key:"port",onChange:n=>void x("port",Number(n.target.value),o)},{label:()=>l("port",{name:"Socks"}),key:"socks-port",onChange:n=>void x("socks-port",Number(n.target.value),o)},{label:()=>l("port",{name:"Redir"}),key:"redir-port",onChange:n=>void x("redir-port",Number(n.target.value),o)},{label:()=>l("port",{name:"TProxy"}),key:"tproxy-port",onChange:n=>void x("tproxy-port",Number(n.target.value),o)},{label:()=>l("port",{name:"Mixed"}),key:"mixed-port",onChange:n=>void x("mixed-port",Number(n.target.value),o)}],{form:b,setInitialValues:C,reset:h}=K({extend:te({schema:Ze})}),[i,{refetch:o}]=ce(Fe);return ee(()=>{const n=i();n&&(C(n),h())}),(()=>{const n=Me(),$=n.firstChild,d=$.firstChild,p=d.nextSibling,w=p.nextSibling,k=$.nextSibling;return $.addEventListener("change",u=>void x("mode",u.target.value,o)),e(d,()=>l("global")),e(p,()=>l("rule")),e(w,()=>l("direct")),e(n,t(T,{get when(){return!M(r())},get children(){return[(()=>{const u=Oe();return Y(b,u,()=>b),e(u,t(I,{each:s,children:c=>(()=>{const v=Qe(),L=v.firstChild,F=L.firstChild,E=L.nextSibling;return e(F,()=>c.label()),oe(E,"change",c.onChange),g(m=>{const B=c.key,N=c.key,P=c.key,A=c.label();return B!==m._v$&&R(L,"for",m._v$=B),N!==m._v$2&&R(E,"id",m._v$2=N),P!==m._v$3&&R(E,"name",m._v$3=P),A!==m._v$4&&R(E,"placeholder",m._v$4=A),m},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),v})()})),u})(),(()=>{const u=Ge(),c=u.firstChild,v=c.firstChild,L=v.firstChild,F=v.nextSibling,E=c.nextSibling,m=E.firstChild,B=m.firstChild,N=m.nextSibling,P=E.nextSibling,A=P.firstChild,le=A.firstChild,U=A.nextSibling,q=P.nextSibling,V=q.firstChild,ae=V.firstChild,z=V.nextSibling,ne=q.nextSibling,H=ne.firstChild,se=H.firstChild,X=H.nextSibling;return e(L,()=>l("allowLan")),F.addEventListener("change",a=>void x("allow-lan",a.target.checked,o)),e(B,()=>l("enableTunDevice")),N.addEventListener("change",a=>void x("tun",{enable:a.target.checked},o)),e(le,()=>l("tunModeStack")),U.addEventListener("change",a=>void x("tun",{stack:a.target.value},o)),e(ae,()=>l("tunDeviceName")),z.addEventListener("change",a=>void x("tun",{device:a.target.value},o)),e(se,()=>l("interfaceName")),X.addEventListener("change",a=>void x("interface-name",a.target.value,o)),g(()=>{var a;return F.checked=(a=i())==null?void 0:a["allow-lan"]}),g(()=>{var a;return N.checked=(a=i())==null?void 0:a.tun.enable}),g(()=>{var a;return U.value=(a=i())==null?void 0:a.tun.stack}),g(()=>{var a;return z.value=(a=i())==null?void 0:a.tun.device}),g(()=>{var a;return X.value=(a=i())==null?void 0:a["interface-name"]}),u})()]}}),k),e(k,t(D,{class:"btn-primary",get loading(){return pe()},onClick:he,get children(){return l("reloadConfig")}}),null),e(k,t(D,{class:"btn-secondary",get loading(){return ve()},onClick:fe,get children(){return l("updateGEODatabases")}}),null),e(k,t(D,{class:"btn-accent",get loading(){return be()},onClick:me,get children(){return l("flushFakeIP")}}),null),e(k,t(T,{get when(){return!M(r())},get children(){return t(D,{class:"btn-error",get loading(){return _e()},onClick:$e,get children(){return l("upgradeCore")}})}}),null),e(k,t(D,{class:"btn-warning",get loading(){return xe()},onClick:Ce,get children(){return l("restartCore")}}),null),e(k,t(D,{class:"btn-info",onClick:()=>{ke(""),_(ye.Setup)},get children(){return l("switchEndpoint")}}),null),g(()=>{var u;return $.value=(u=i())==null?void 0:u.mode}),g(()=>d.value=O.Global),g(()=>p.value=O.Rule),g(()=>w.value=O.Direct),n})()},Ke=()=>{const[r]=j(),l=[{label:()=>r("en"),value:W.EN},{label:()=>r("zh"),value:W.ZH}];return(()=>{const _=qe(),s=_.firstChild,b=s.firstChild,C=b.firstChild,h=b.nextSibling,i=h.firstChild,o=s.nextSibling,n=o.firstChild,$=n.firstChild;return e(b,t(S,{get children(){return r("useTwemoji")}}),C),C.addEventListener("change",d=>Se(d.target.checked)),e(h,t(S,{get children(){return r("switchLanguage")}}),i),i.addEventListener("change",d=>we(d.target.value)),e(i,t(I,{each:l,children:d=>(()=>{const p=G();return e(p,()=>d.label()),g(()=>p.selected=Ee()===d.value),g(()=>p.value=d.value),p})()})),e(n,t(S,{get children(){return r("autoSwitchTheme")}}),$),$.addEventListener("change",d=>De(d.target.checked)),e(o,t(T,{get when(){return Z()},get children(){const d=Ue(),p=d.firstChild,w=p.firstChild,k=p.nextSibling,u=k.firstChild;return e(p,t(S,{get children(){return r("favDayTheme")}}),w),w.addEventListener("change",c=>Te(c.target.value)),e(w,t(I,{each:J,children:c=>(()=>{const v=G();return v.value=c,e(v,c),v})()})),e(k,t(S,{get children(){return r("favNightTheme")}}),u),u.addEventListener("change",c=>Le(c.target.value)),e(u,t(I,{each:J,children:c=>(()=>{const v=G();return v.value=c,e(v,c),v})()})),g(()=>w.value=Ne()),g(()=>u.value=Pe()),d}}),null),g(()=>C.checked=Ae()),g(()=>$.checked=Z()),_})()},Ye=({backendVersion:r})=>{const[l,_]=Q(!1);return ee(async()=>{const s=r();s&&_(await Ie(s))}),(()=>{const s=ze(),b=s.firstChild,C=b.nextSibling,h=C.firstChild;return e(b,()=>"1.134.0"),e(C,t(T,{get when(){return l()},get children(){return Ve()}}),h),e(h,r),s})()},at=()=>{const[r]=j(),[l,_]=Q("");return re(async()=>{_(await ue())}),(()=>{const s=He();return e(s,t(T,{get when(){return!M(l())},get children(){return[t(S,{withDivider:!0,get children(){return r("dnsQuery")}}),t(We,{})]}}),null),e(s,t(S,{withDivider:!0,get children(){return r("coreConfig")}}),null),e(s,t(Je,{backendVersion:l}),null),e(s,t(S,{withDivider:!0,get children(){return r("xdConfig")}}),null),e(s,t(Ke,{}),null),e(s,t(S,{withDivider:!0,get children(){return r("version")}}),null),e(s,t(Ye,{backendVersion:l}),null),s})()};export{at as default};
